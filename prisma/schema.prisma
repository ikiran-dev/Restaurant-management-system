// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String     @id @default(cuid())
  email     String     @unique
  password  String
  name      String?
  role      Role       @default(RESTAURANT_OWNER)
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt

  restaurants Restaurant[]

  @@index([email])
}

enum Role {
  RESTAURANT_OWNER
  ADMIN
}

model Restaurant {
  id          String   @id @default(cuid())
  userId      String
  name        String
  description String?
  location    String?
  phone       String?
  email       String?
  logo        String?
  theme       String   @default("light")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  user        User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  categories  Category[]
  menus       Menu[]

  @@index([userId])
}


model Category {
  id           String   @id @default(cuid())
  restaurantId String
  name         String
  description  String?
  displayOrder Int      @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  restaurant Restaurant @relation(fields: [restaurantId], references: [id], onDelete: Cascade)
  dishes     Dish[]

  @@index([restaurantId])
}

model Dish {
  id          String   @id @default(cuid())
  categoryId  String
  name        String
  description String?
  price       Decimal  @db.Decimal(10, 2)
  image       String?
  available   Boolean  @default(true)
  displayOrder Int     @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  category Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@index([categoryId])
}

model Menu {
  id           String   @id @default(cuid())
  restaurantId String
  name         String
  slug         String   @unique
  isPublic     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  restaurant Restaurant @relation(fields: [restaurantId], references: [id], onDelete: Cascade)

  @@index([restaurantId])
  @@index([slug])
}
